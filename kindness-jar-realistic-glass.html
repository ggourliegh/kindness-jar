<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Kindness Jar - Spread Love & Joy Every Single Day!</title>
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://js.stripe.com/v3/"></script>
  <link
    href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&family=Caveat:wght@700&family=Pacifico&display=swap"
    rel="stylesheet">

  <!-- Font Awesome Icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

  <!-- PWA Manifest -->
  <link rel="manifest" href="/manifest.json">

  <!-- Theme Color -->
  <meta name="theme-color" content="#1a0b2e">

  <!-- iOS Support -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <meta name="apple-mobile-web-app-title" content="Daily Kindness">
  <link rel="apple-touch-icon" href="/icons/apple-touch-icon.png">

  <!-- Standard Favicon -->
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/icon-192x192.png">
  <link rel="icon" type="image/png" sizes="512x512" href="/icons/icon-512x512.png">

  <!-- Meta description for SEO and share cards -->
  <meta name="description" content="Daily acts of kindness to make the world a better place. Choose a category, get a suggestion, and spread positivity!">

  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Poppins', sans-serif;
      background: linear-gradient(180deg, #2d1b4e 0%, #2a3a5e 30%, #1f4d7a 70%, #2a2a4e 100%);
      min-height: 100vh;
      overflow-x: hidden;
      position: relative;
    }

    .app-container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 40px 20px;
      min-height: 100vh;
    }

    .app-header {
      text-align: center;
      padding: 0 0 40px;
    }

    .app-title {
      font-family: 'Pacifico', cursive;
      font-size: 3.5rem;
      font-weight: 400;
      background: linear-gradient(135deg, #00D9FF 0%, #00F0FF 30%, #FF2DF7 70%, #FF00FF 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      letter-spacing: 2px;
      margin-bottom: 8px;
      text-transform: none;
      position: relative;
      display: inline-block;
      filter: drop-shadow(0 0 15px rgba(0, 217, 255, 0.8)) drop-shadow(0 0 30px rgba(255, 0, 255, 0.6));
    }

    /* Decorative swirls before title */
    .app-title::before {
      content: '‚ú®üíù';
      position: absolute;
      left: -70px;
      top: 50%;
      transform: translateY(-50%);
      font-size: 1.8rem;
      filter: drop-shadow(1px 1px 2px rgba(0, 0, 0, 0.3));
    }

    /* Decorative swirls after title */
    .app-title::after {
      content: 'üíù‚ú®';
      position: absolute;
      right: -70px;
      top: 50%;
      transform: translateY(-50%);
      font-size: 1.8rem;
      filter: drop-shadow(1px 1px 2px rgba(0, 0, 0, 0.3));
    }

    .app-subtitle {
      font-family: 'Quicksand', sans-serif;
      font-size: 1.4rem;
      color: #00F0FF;
      font-weight: 600;
      margin-bottom: 30px;
      filter: drop-shadow(0 0 10px rgba(0, 240, 255, 0.8));
      text-shadow: 0 0 20px rgba(0, 240, 255, 0.5);
    }

    .button-row {
      display: flex;
      gap: 15px;
      justify-content: center;
      flex-wrap: wrap;
    }

    .header-button {
      background: rgba(0, 217, 255, 0.1);
      color: #00F0FF;
      border: 2px solid #00D9FF;
      padding: 12px 28px;
      border-radius: 25px;
      font-family: 'Poppins', sans-serif;
      font-weight: 600;
      cursor: pointer;
      font-size: 1rem;
      box-shadow: 0 0 15px rgba(0, 217, 255, 0.5), 0 4px 12px rgba(0, 0, 0, 0.3);
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      gap: 8px;
      text-shadow: 0 0 10px rgba(0, 240, 255, 0.8);
    }

    .header-button:hover {
      transform: translateY(-2px);
      box-shadow: 0 0 25px rgba(0, 217, 255, 0.8), 0 6px 20px rgba(0, 0, 0, 0.4);
      background: rgba(0, 217, 255, 0.2);
      border-color: #00F0FF;
    }

    .header-button.donate {
      background: rgba(255, 0, 255, 0.2);
      border-color: #FF00FF;
      color: #FF2DF7;
      box-shadow: 0 0 15px rgba(255, 0, 255, 0.6), 0 4px 12px rgba(0, 0, 0, 0.3);
      text-shadow: 0 0 10px rgba(255, 0, 255, 0.8);
    }

    .header-button.install {
      background: rgba(0, 255, 65, 0.2);
      border-color: #00FF41;
      color: #39FF14;
      box-shadow: 0 0 15px rgba(0, 255, 65, 0.6), 0 4px 12px rgba(0, 0, 0, 0.3);
      text-shadow: 0 0 10px rgba(57, 255, 20, 0.8);
      animation: pulse 2s ease-in-out infinite;
    }

    @keyframes pulse {
      0%, 100% {
        box-shadow: 0 0 15px rgba(0, 255, 65, 0.6), 0 4px 12px rgba(0, 0, 0, 0.3);
      }
      50% {
        box-shadow: 0 0 30px rgba(0, 255, 65, 0.9), 0 6px 20px rgba(0, 0, 0, 0.4);
      }
    }

    .shelf-container {
      background:
        radial-gradient(circle at 20% 30%, rgba(157, 78, 221, 0.08) 0%, transparent 50%),
        radial-gradient(circle at 80% 70%, rgba(0, 217, 255, 0.08) 0%, transparent 50%),
        radial-gradient(circle at 50% 50%, rgba(255, 0, 255, 0.05) 0%, transparent 70%),
        linear-gradient(135deg, #f8f5fb 0%, #f5f8fc 50%, #f8f5fb 100%);
      padding: 50px 30px 50px;
      border-radius: 20px;
      box-shadow: 0 10px 40px rgba(0, 0, 0, 0.15), inset 0 1px 2px rgba(255, 255, 255, 0.8);
      position: relative;
      margin-top: 20px;
      border: 1px solid rgba(157, 78, 221, 0.15);
    }

    .shelf {
      position: relative;
      margin-bottom: 80px;
      padding-bottom: 20px;
    }

    .shelf:last-child {
      margin-bottom: 0;
    }

    /* Realistic wooden shelf */
    .shelf::after {
      content: '';
      position: absolute;
      bottom: -30px;
      left: -10px;
      right: -10px;
      height: 18px;
      background: linear-gradient(180deg,
          #A68968 0%,
          #9D7E5E 10%,
          #8B6F4E 50%,
          #7D6344 90%,
          #6B533A 100%);
      border-radius: 6px;
      box-shadow:
        0 8px 16px rgba(0, 0, 0, 0.3),
        inset 0 2px 4px rgba(255, 255, 255, 0.2),
        inset 0 -2px 4px rgba(0, 0, 0, 0.3);
    }

    /* Wood grain effect */
    .shelf::before {
      content: '';
      position: absolute;
      bottom: -30px;
      left: -10px;
      right: -10px;
      height: 18px;
      background-image:
        repeating-linear-gradient(90deg,
          transparent,
          transparent 60px,
          rgba(0, 0, 0, 0.05) 60px,
          rgba(0, 0, 0, 0.05) 61px);
      z-index: 1;
      border-radius: 6px;
    }

    .jar-grid {
      display: grid;
      grid-template-columns: repeat(5, 1fr);
      gap: 35px;
      max-width: 1100px;
      margin: 0 auto;
    }

    @media (max-width: 1024px) {
      .jar-grid {
        grid-template-columns: repeat(3, 1fr);
      }
    }

    @media (max-width: 640px) {
      .jar-grid {
        grid-template-columns: repeat(2, 1fr);
        gap: 20px;
        padding: 0 10px;
      }

      .app-container {
        padding: 30px 15px;
      }

      .app-title {
        font-size: 2.2rem;
        letter-spacing: 1px;
        margin-bottom: 6px;
      }

      .app-subtitle {
        font-size: 1.2rem;
        margin-bottom: 20px;
      }

      .shelf-container {
        padding: 40px 15px 40px;
      }

      .shelf {
        margin-bottom: 60px;
      }

      /* Hide the default desktop shelf lines in mobile */
      .shelf::after,
      .shelf::before {
        display: none;
      }

      /* Mobile shelf styling - appears between jar rows */
      .mobile-shelf {
        grid-column: 1 / -1;
        /* Span all columns */
        height: 18px;
        margin: 10px -10px 30px -10px;
        /* Extend beyond grid padding */
        background: linear-gradient(180deg,
            #A68968 0%,
            #9D7E5E 10%,
            #8B6F4E 50%,
            #7D6344 90%,
            #6B533A 100%);
        border-radius: 6px;
        box-shadow:
          0 8px 16px rgba(0, 0, 0, 0.3),
          inset 0 2px 4px rgba(255, 255, 255, 0.2),
          inset 0 -2px 4px rgba(0, 0, 0, 0.3);
        position: relative;
      }

      /* Wood grain effect for mobile shelves */
      .mobile-shelf::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background-image:
          repeating-linear-gradient(90deg,
            transparent,
            transparent 60px,
            rgba(0, 0, 0, 0.05) 60px,
            rgba(0, 0, 0, 0.05) 61px);
        border-radius: 6px;
      }

      /* Add extra margin to jar items to accommodate shelves */
      .jar-item {
        margin-bottom: 50px;
      }

      .jar-container {
        max-width: 140px;
      }

      .jar-label-sticker {
        font-size: 0.75rem;
        padding: 3px 6px;
        height: 18%;
      }

      .jar-icon {
        font-size: 3rem;
      }

      .header-button {
        padding: 10px 20px;
        font-size: 0.9rem;
      }

      .note-card {
        padding: 30px 20px;
        max-width: 90%;
      }

      .note-icon {
        font-size: 4rem;
      }
    }

    .jar-item {
      display: flex;
      flex-direction: column;
      align-items: center;
      cursor: pointer;
      transition: transform 0.3s ease;
      position: relative;
    }

    .jar-item:hover .jar-container {
      transform: translateY(-10px);
    }

    .jar-container {
      position: relative;
      width: 100%;
      max-width: 165px;
      aspect-ratio: 2/3;
      transition: transform 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      filter: drop-shadow(0 15px 30px rgba(0, 0, 0, 0.25));
    }

    .jar-container.wiggle {
      animation: smoothWiggle 0.7s cubic-bezier(0.36, 0.07, 0.19, 0.97);
    }

    @keyframes smoothWiggle {

      0%,
      100% {
        transform: rotate(0deg) translateY(0);
      }

      12% {
        transform: rotate(-10deg) translateY(-15px);
      }

      24% {
        transform: rotate(8deg) translateY(-18px);
      }

      36% {
        transform: rotate(-6deg) translateY(-15px);
      }

      48% {
        transform: rotate(4deg) translateY(-10px);
      }

      60% {
        transform: rotate(-2deg) translateY(-5px);
      }

      72% {
        transform: rotate(1deg) translateY(-3px);
      }

      84% {
        transform: rotate(0deg) translateY(-1px);
      }
    }

    .jar {
      position: relative;
      width: 100%;
      height: 100%;
    }

    /* Ultra-realistic metallic threaded lid */
    .jar-lid {
      position: absolute;
      top: 0;
      left: 50%;
      transform: translateX(-50%);
      width: 68%;
      height: 13%;
      background:
        linear-gradient(180deg,
          #E8D4BA 0%,
          #D4BFA8 10%,
          #C9B197 25%,
          #B39F86 40%,
          #A08D74 60%,
          #8B7A61 80%,
          #7D6B53 100%);
      border-radius: 10px 10px 3px 3px;
      z-index: 5;
      box-shadow:
        0 5px 12px rgba(0, 0, 0, 0.5),
        inset 0 3px 6px rgba(255, 255, 255, 0.6),
        inset 0 -3px 6px rgba(0, 0, 0, 0.5),
        0 1px 0 rgba(255, 255, 255, 0.3);
    }

    /* Lid threading ridges */
    .jar-lid::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-image: repeating-linear-gradient(180deg,
          transparent 0px,
          rgba(0, 0, 0, 0.15) 2px,
          transparent 2px,
          transparent 4px,
          rgba(255, 255, 255, 0.1) 4px,
          transparent 5px);
      border-radius: 10px 10px 3px 3px;
    }

    /* Lid knob */
    .jar-lid::after {
      content: '';
      position: absolute;
      top: -7px;
      left: 50%;
      transform: translateX(-50%);
      width: 32%;
      height: 11px;
      background:
        radial-gradient(ellipse at 50% 30%,
          #E8D4BA 0%,
          #D4BFA8 40%,
          #C0AB94 70%,
          #A89680 100%);
      border-radius: 50%;
      box-shadow:
        0 3px 6px rgba(0, 0, 0, 0.4),
        inset 0 1px 2px rgba(255, 255, 255, 0.5);
    }

    /* Super realistic glass jar body with transparency (ENHANCED) */
    .jar-body {
      position: absolute;
      top: 11%;
      left: 50%;
      transform: translateX(-50%);
      width: 84%;
      height: 84%;
      background:
        linear-gradient(135deg,
          var(--jar-color-light) 0%,
          var(--jar-color-main) 40%,
          var(--jar-color-main) 60%,
          var(--jar-color-dark) 100%);
      border-radius: 14px 14px 24px 24px;
      z-index: 2;
      box-shadow:
        inset -10px -10px 25px rgba(0, 0, 0, 0.25),
        inset 10px 10px 25px rgba(255, 255, 255, 0.7),
        0 25px 50px rgba(0, 0, 0, 0.35),
        0 0 0 1.5px rgba(255, 255, 255, 0.6),
        0 0 0 3px rgba(255, 255, 255, 0.2);
      position: relative;
      overflow: hidden;
    }

    /* Primary highlight - left side shine (ENHANCED for realism) */
    .jar-body::before {
      content: '';
      position: absolute;
      top: 5%;
      left: 5%;
      width: 45%;
      height: 70%;
      background:
        linear-gradient(140deg,
          rgba(255, 255, 255, 0.95) 0%,
          rgba(255, 255, 255, 0.75) 25%,
          rgba(255, 255, 255, 0.4) 50%,
          rgba(255, 255, 255, 0.15) 75%,
          transparent 100%);
      border-radius: 50%;
      filter: blur(10px);
      z-index: 3;
    }

    /* Secondary highlight - right side */
    .jar-body::after {
      content: '';
      position: absolute;
      top: 20%;
      right: 10%;
      width: 28%;
      height: 45%;
      background:
        radial-gradient(ellipse at 50% 50%,
          rgba(255, 255, 255, 0.4) 0%,
          rgba(255, 255, 255, 0.15) 50%,
          transparent 100%);
      border-radius: 50%;
      filter: blur(10px);
      z-index: 3;
    }

    /* Inner glow layer */
    .jar-inner-glow {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background:
        radial-gradient(ellipse at 50% 50%,
          rgba(255, 255, 255, 0.3) 0%,
          transparent 70%);
      z-index: 1;
    }

    /* Glass thickness edge effect (ENHANCED for photo-realism) */
    .jar-edge-highlight {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      border-radius: 14px 14px 24px 24px;
      box-shadow:
        inset 0 0 0 2.5px rgba(255, 255, 255, 0.75),
        inset 4px 4px 12px rgba(255, 255, 255, 0.55),
        inset -2px -2px 10px rgba(0, 0, 0, 0.15);
      z-index: 4;
      pointer-events: none;
    }

    /* Bottom glass curve highlight */
    .jar-bottom-curve {
      position: absolute;
      bottom: 5%;
      left: 15%;
      right: 15%;
      height: 25%;
      background:
        radial-gradient(ellipse at 50% 80%,
          rgba(255, 255, 255, 0.3) 0%,
          transparent 60%);
      border-radius: 50%;
      filter: blur(8px);
      z-index: 2;
    }

    /* Clean soft white label with dark text */
    .jar-label-sticker {
      position: absolute;
      bottom: 16%;
      left: 50%;
      transform: translateX(-50%);
      width: 72%;
      height: 20%;
      background:
        linear-gradient(180deg,
          rgba(255, 255, 255, 0.95) 0%,
          rgba(250, 250, 250, 0.95) 50%,
          rgba(255, 255, 255, 0.95) 100%);
      border-radius: 6px;
      z-index: 5;
      box-shadow:
        0 3px 8px rgba(0, 0, 0, 0.2),
        inset 0 1px 2px rgba(255, 255, 255, 0.9);
      display: flex;
      align-items: center;
      justify-content: center;
      font-family: 'Poppins', sans-serif;
      font-size: 0.88rem;
      color: #4A5568;
      font-weight: 600;
      padding: 4px 8px;
      border: 1px solid rgba(0, 0, 0, 0.05);
      text-shadow: none;
    }

    /* Icon inside jar with colorful styling */
    .jar-icon {
      position: absolute;
      top: 35%;
      left: 50%;
      transform: translate(-50%, -50%);
      font-size: 3.5rem;
      z-index: 3;
      animation: subtleFloat 3.5s ease-in-out infinite;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .jar-icon i {
      color: #FFFFFF;
      filter: drop-shadow(0 4px 12px rgba(0, 0, 0, 0.3));
      text-shadow:
        0 0 20px rgba(255, 255, 255, 0.9),
        0 0 30px rgba(255, 255, 255, 0.7),
        0 2px 8px rgba(0, 0, 0, 0.4);
      display: block;
    }

    @keyframes subtleFloat {

      0%,
      100% {
        transform: translate(-50%, -50%) translateY(0px);
      }

      50% {
        transform: translate(-50%, -50%) translateY(-7px);
      }
    }

    /* Shadow under jar on shelf (ENHANCED for photo-realism) */
    .jar-shadow {
      position: absolute;
      bottom: -18px;
      left: 50%;
      transform: translateX(-50%);
      width: 80%;
      height: 15px;
      background: radial-gradient(ellipse at 50% 50%,
          rgba(0, 0, 0, 0.45) 0%,
          rgba(0, 0, 0, 0.25) 40%,
          rgba(0, 0, 0, 0.1) 70%,
          transparent 100%);
      border-radius: 50%;
      filter: blur(8px);
      z-index: 1;
    }

    /* Note overlay - unchanged */
    .note-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.6);
      backdrop-filter: blur(8px);
      z-index: 1000;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 20px;
      animation: fadeIn 0.3s;
    }

    .note-card {
      background: linear-gradient(135deg, rgba(20, 20, 40, 0.95) 0%, rgba(30, 30, 50, 0.95) 100%);
      border-radius: 20px;
      padding: 40px;
      max-width: 550px;
      width: 100%;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.6), 0 0 40px rgba(0, 217, 255, 0.3);
      border: 2px solid rgba(0, 217, 255, 0.4);
      animation: slideUp 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
      }

      to {
        opacity: 1;
      }
    }

    @keyframes slideUp {
      from {
        transform: translateY(50px);
        opacity: 0;
      }

      to {
        transform: translateY(0);
        opacity: 1;
      }
    }

    .note-icon {
      text-align: center;
      font-size: 5rem;
      margin-bottom: 20px;
      animation: iconPop 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275) 0.2s both;
    }

    @keyframes iconPop {
      from {
        transform: scale(0);
        opacity: 0;
      }

      to {
        transform: scale(1);
        opacity: 1;
      }
    }

    .note-category {
      text-align: center;
      font-size: 0.9rem;
      font-weight: 600;
      color: #00D9FF;
      margin-bottom: 12px;
      text-transform: uppercase;
      letter-spacing: 2px;
      text-shadow: 0 0 10px rgba(0, 217, 255, 0.8);
    }

    .note-title {
      text-align: center;
      font-size: 1.6rem;
      font-weight: 700;
      color: #FF2DF7;
      margin-bottom: 20px;
      font-family: 'Poppins', sans-serif;
      text-shadow: 0 0 15px rgba(255, 0, 255, 0.8);
    }

    .note-text {
      font-size: 1.2rem;
      line-height: 1.8;
      color: #B0E0FF;
      text-align: center;
      margin-bottom: 30px;
      font-weight: 400;
      text-shadow: 0 0 5px rgba(176, 224, 255, 0.3);
    }

    .ai-badge {
      display: inline-block;
      background: rgba(157, 78, 221, 0.2);
      border: 1px solid #9D4EDD;
      color: #B967FF;
      padding: 6px 14px;
      border-radius: 20px;
      font-size: 0.75rem;
      margin-bottom: 15px;
      font-weight: 600;
      box-shadow: 0 0 10px rgba(157, 78, 221, 0.5);
      text-shadow: 0 0 8px rgba(185, 103, 255, 0.8);
    }

    .note-buttons {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .note-button {
      padding: 16px;
      border: none;
      border-radius: 12px;
      font-family: 'Poppins', sans-serif;
      font-weight: 600;
      font-size: 1.05rem;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    }

    .note-button:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);
    }

    .note-button:active {
      transform: scale(0.98);
    }

    .note-button.primary {
      background: rgba(0, 255, 65, 0.2);
      border: 2px solid #00FF41;
      color: #39FF14;
      box-shadow: 0 0 15px rgba(0, 255, 65, 0.6), 0 4px 12px rgba(0, 0, 0, 0.3);
      text-shadow: 0 0 10px rgba(57, 255, 20, 0.8);
    }

    .note-button.secondary {
      background: rgba(255, 109, 0, 0.2);
      border: 2px solid #FF6D00;
      color: #FF9E00;
      box-shadow: 0 0 15px rgba(255, 109, 0, 0.6), 0 4px 12px rgba(0, 0, 0, 0.3);
      text-shadow: 0 0 10px rgba(255, 158, 0, 0.8);
    }

    .note-button.ai {
      background: rgba(157, 78, 221, 0.2);
      border: 2px solid #9D4EDD;
      color: #B967FF;
      box-shadow: 0 0 15px rgba(157, 78, 221, 0.6), 0 4px 12px rgba(0, 0, 0, 0.3);
      text-shadow: 0 0 10px rgba(185, 103, 255, 0.8);
    }

    .note-button.tertiary {
      background: transparent;
      color: #00D9FF;
      box-shadow: none;
      border: 1px solid rgba(0, 217, 255, 0.3);
      text-shadow: 0 0 5px rgba(0, 217, 255, 0.5);
    }

    .note-button.tertiary:hover {
      color: #00F0FF;
      border-color: rgba(0, 240, 255, 0.5);
      box-shadow: 0 0 10px rgba(0, 240, 255, 0.4);
    }

    /* Confetti celebration */
    .completed-animation {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: 2000;
      pointer-events: none;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .completed-check {
      font-size: 12rem;
      animation: checkPulse 1s ease-out;
      filter: drop-shadow(0 0 30px rgba(72, 187, 120, 0.8));
    }

    @keyframes checkPulse {
      0% {
        transform: scale(0) rotate(-180deg);
        opacity: 0;
      }

      50% {
        transform: scale(1.3) rotate(10deg);
        opacity: 1;
      }

      100% {
        transform: scale(0) rotate(180deg);
        opacity: 0;
      }
    }

    .confetti {
      position: absolute;
      width: 12px;
      height: 12px;
      animation: confettiFall 3s ease-out forwards;
    }

    @keyframes confettiFall {
      to {
        transform: translateY(100vh) translateX(var(--x)) rotate(720deg);
        opacity: 0;
      }
    }

    .loading-spinner {
      display: inline-block;
      width: 18px;
      height: 18px;
      border: 3px solid rgba(255, 255, 255, 0.3);
      border-top-color: white;
      border-radius: 50%;
      animation: spin 0.8s linear infinite;
      margin-right: 8px;
    }

    @keyframes spin {
      to {
        transform: rotate(360deg);
      }
    }

    /* Donation modal */
    .donation-modal {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.7);
      backdrop-filter: blur(10px);
      z-index: 1000;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 20px;
      animation: fadeIn 0.3s;
    }

    .donation-content {
      background: linear-gradient(135deg, rgba(20, 20, 40, 0.95) 0%, rgba(30, 30, 50, 0.95) 100%);
      border-radius: 20px;
      padding: 45px 35px;
      max-width: 480px;
      width: 100%;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.6), 0 0 40px rgba(255, 0, 255, 0.3);
      border: 2px solid rgba(255, 0, 255, 0.4);
      animation: slideUp 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    }

    .donation-title {
      font-family: 'Poppins', sans-serif;
      font-size: 2rem;
      font-weight: 700;
      color: #FF2DF7;
      text-align: center;
      margin-bottom: 15px;
      text-shadow: 0 0 15px rgba(255, 0, 255, 0.8);
    }

    .donation-message {
      font-size: 1.1rem;
      color: #B0E0FF;
      text-align: center;
      margin-bottom: 30px;
      line-height: 1.6;
      text-shadow: 0 0 5px rgba(176, 224, 255, 0.3);
    }

    .donation-options {
      display: flex;
      gap: 12px;
      margin-bottom: 20px;
      justify-content: center;
      flex-wrap: wrap;
    }

    .donation-amount {
      background: rgba(255, 0, 255, 0.1);
      border: 2px solid rgba(255, 0, 255, 0.4);
      padding: 14px 26px;
      border-radius: 12px;
      font-family: 'Poppins', sans-serif;
      font-weight: 600;
      font-size: 1.2rem;
      cursor: pointer;
      transition: all 0.3s;
      color: #FF2DF7;
      box-shadow: 0 0 10px rgba(255, 0, 255, 0.3);
      text-shadow: 0 0 8px rgba(255, 45, 247, 0.6);
    }

    .donation-amount:hover {
      border-color: rgba(255, 0, 255, 0.6);
      transform: translateY(-2px);
      box-shadow: 0 0 20px rgba(255, 0, 255, 0.5), 0 4px 12px rgba(0, 0, 0, 0.3);
    }

    .donation-amount.selected {
      background: rgba(255, 0, 255, 0.3);
      border-color: #FF00FF;
      color: #FFFFFF;
      box-shadow: 0 0 25px rgba(255, 0, 255, 0.8), 0 4px 12px rgba(0, 0, 0, 0.4);
      text-shadow: 0 0 10px rgba(255, 0, 255, 1);
    }

    .custom-amount {
      width: 100%;
      padding: 14px 18px;
      border: 2px solid rgba(255, 0, 255, 0.4);
      border-radius: 12px;
      font-family: 'Poppins', sans-serif;
      font-size: 1.1rem;
      text-align: center;
      margin-bottom: 20px;
      background: rgba(255, 0, 255, 0.1);
      color: #FF2DF7;
      box-shadow: 0 0 10px rgba(255, 0, 255, 0.2);
    }

    .custom-amount:focus {
      outline: none;
      border-color: #FF00FF;
      box-shadow: 0 0 20px rgba(255, 0, 255, 0.6);
    }

    /* Custom image upload */
    .jar-edit-button {
      position: absolute;
      top: -8px;
      right: -8px;
      width: 32px;
      height: 32px;
      background: rgba(157, 78, 221, 0.2);
      border: 2px solid rgba(157, 78, 221, 0.6);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      z-index: 10;
      opacity: 0;
      transition: all 0.3s ease;
      box-shadow: 0 0 10px rgba(157, 78, 221, 0.4), 0 2px 8px rgba(0, 0, 0, 0.3);
      font-size: 0.9rem;
      color: #B967FF;
    }

    .jar-item:hover .jar-edit-button {
      opacity: 1;
    }

    .jar-edit-button:hover {
      background: rgba(157, 78, 221, 0.4);
      border-color: #9D4EDD;
      color: #B967FF;
      transform: scale(1.1);
      box-shadow: 0 0 20px rgba(157, 78, 221, 0.7), 0 2px 8px rgba(0, 0, 0, 0.4);
    }

    .custom-image-icon {
      width: 100%;
      height: 100%;
      border-radius: 50%;
      object-fit: cover;
      object-position: center;
      display: block;
    }

    .jar-icon.has-custom-image {
      font-size: 0;
      width: 65px;
      height: 65px;
      border-radius: 50%;
      overflow: hidden;
      border: 3px solid rgba(255, 255, 255, 0.9);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.25);
      display: flex;
      align-items: center;
      justify-content: center;
      background: white;
    }

    .jar-icon.has-custom-image img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      object-position: center;
    }

    /* Edit image modal */
    .edit-image-modal {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.7);
      backdrop-filter: blur(10px);
      z-index: 1000;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 20px;
      animation: fadeIn 0.3s;
    }

    .edit-image-content {
      background: linear-gradient(135deg, rgba(20, 20, 40, 0.95) 0%, rgba(30, 30, 50, 0.95) 100%);
      border-radius: 20px;
      padding: 40px;
      max-width: 450px;
      width: 100%;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.6), 0 0 40px rgba(157, 78, 221, 0.3);
      border: 2px solid rgba(157, 78, 221, 0.4);
      animation: slideUp 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    }

    .edit-image-preview {
      width: 150px;
      height: 150px;
      border-radius: 50%;
      margin: 0 auto 25px;
      border: 4px solid rgba(157, 78, 221, 0.6);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 5rem;
      overflow: hidden;
      background: rgba(20, 20, 40, 0.6);
      box-shadow: 0 0 20px rgba(157, 78, 221, 0.4);
    }

    .edit-image-preview img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .image-upload-input {
      display: none;
    }

    .image-upload-label {
      display: block;
      width: 100%;
      padding: 16px;
      background: rgba(157, 78, 221, 0.2);
      border: 2px solid #9D4EDD;
      color: #B967FF;
      border-radius: 12px;
      text-align: center;
      cursor: pointer;
      font-family: 'Poppins', sans-serif;
      font-weight: 600;
      font-size: 1.05rem;
      margin-bottom: 12px;
      transition: all 0.3s ease;
      box-shadow: 0 0 15px rgba(157, 78, 221, 0.5), 0 4px 12px rgba(0, 0, 0, 0.3);
      text-shadow: 0 0 10px rgba(185, 103, 255, 0.8);
    }

    .image-upload-label:hover {
      transform: translateY(-2px);
      box-shadow: 0 0 25px rgba(157, 78, 221, 0.7), 0 6px 20px rgba(0, 0, 0, 0.4);
      border-color: #B967FF;
    }

    .image-upload-label:active {
      transform: scale(0.98);
    }

    .image-info {
      font-size: 0.9rem;
      color: #B0E0FF;
      text-align: center;
      margin-bottom: 20px;
      line-height: 1.5;
      text-shadow: 0 0 5px rgba(176, 224, 255, 0.3);
    }

    /* Stats Dashboard Styles */
    .stats-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 15px;
      margin-bottom: 25px;
    }

    .stat-card {
      background: rgba(157, 78, 221, 0.2);
      border: 2px solid #9D4EDD;
      padding: 20px;
      border-radius: 12px;
      text-align: center;
      color: #B967FF;
      box-shadow: 0 0 15px rgba(157, 78, 221, 0.5), 0 4px 12px rgba(0, 0, 0, 0.3);
    }

    .stat-card.green {
      background: rgba(0, 255, 65, 0.2);
      border-color: #00FF41;
      color: #39FF14;
      box-shadow: 0 0 15px rgba(0, 255, 65, 0.5), 0 4px 12px rgba(0, 0, 0, 0.3);
    }

    .stat-card.orange {
      background: rgba(255, 109, 0, 0.2);
      border-color: #FF6D00;
      color: #FF9E00;
      box-shadow: 0 0 15px rgba(255, 109, 0, 0.5), 0 4px 12px rgba(0, 0, 0, 0.3);
    }

    .stat-card.blue {
      background: rgba(0, 217, 255, 0.2);
      border-color: #00D9FF;
      color: #00F0FF;
      box-shadow: 0 0 15px rgba(0, 217, 255, 0.5), 0 4px 12px rgba(0, 0, 0, 0.3);
    }

    .stat-number {
      font-size: 2.5rem;
      font-weight: bold;
      margin-bottom: 5px;
    }

    .stat-label {
      font-size: 0.85rem;
      opacity: 0.9;
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    .stats-section {
      background: rgba(20, 20, 40, 0.6);
      border-radius: 12px;
      padding: 20px;
      margin-bottom: 20px;
      border: 1px solid rgba(0, 217, 255, 0.3);
      box-shadow: 0 0 20px rgba(0, 217, 255, 0.2);
    }

    .stats-section-title {
      fontSize: '0.9rem',
        fontWeight: '600',
        color: '#4A5568',
        marginBottom: '15px',
        textTransform: 'uppercase',
        letterSpacing: '1px',
        display: 'flex',
        alignItems: 'center',
        gap: '8px'
    }

    .category-bar-chart {
      margin-bottom: 12px;
    }

    .category-bar {
      display: flex;
      align-items: center;
      margin-bottom: 10px;
    }

    .category-bar-label {
      min-width: 120px;
      font-size: 0.95rem;
      color: #4A5568;
    }

    .category-bar-fill {
      flex: 1;
      height: 28px;
      background: #E2E8F0;
      border-radius: 6px;
      position: relative;
      overflow: hidden;
    }

    .category-bar-value {
      height: 100%;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      border-radius: 6px;
      display: flex;
      align-items: center;
      justify-content: flex-end;
      padding-right: 10px;
      color: white;
      font-weight: bold;
      font-size: 0.9rem;
      transition: width 0.6s ease;
    }

    .day-chart {
      display: flex;
      gap: 6px;
      align-items: flex-end;
      height: 120px;
      margin-top: 15px;
      padding: 0 5px;
    }

    .day-bar {
      flex: 1;
      background: linear-gradient(180deg, #667eea 0%, #764ba2 100%);
      border-radius: 4px 4px 0 0;
      position: relative;
      min-height: 4px;
      transition: all 0.3s ease;
      cursor: pointer;
    }

    .day-bar:hover {
      opacity: 0.8;
      transform: translateY(-2px);
    }

    .day-bar-label {
      position: absolute;
      bottom: -25px;
      left: 50%;
      transform: translateX(-50%);
      font-size: 0.75rem;
      color: #718096;
      white-space: nowrap;
    }

    .day-bar-count {
      position: absolute;
      top: -20px;
      left: 50%;
      transform: translateX(-50%);
      font-size: 0.75rem;
      font-weight: bold;
      color: #4A5568;
      white-space: nowrap;
    }

    .insight-box {
      background: linear-gradient(135deg, #FFF5F5 0%, #FED7D7 100%);
      border-left: 4px solid #F56565;
      padding: 15px;
      border-radius: 8px;
      margin-top: 15px;
    }

    .insight-box.success {
      background: linear-gradient(135deg, #F0FFF4 0%, #C6F6D5 100%);
      border-left-color: #48BB78;
    }

    .insight-box.info {
      background: linear-gradient(135deg, #EBF8FF 0%, #BEE3F8 100%);
      border-left-color: #4299E1;
    }

    .insight-text {
      font-size: 0.95rem;
      color: #2D3748;
      line-height: 1.6;
    }

    .stats-tabs {
      display: flex;
      gap: 10px;
      margin-bottom: 20px;
      border-bottom: 2px solid #E2E8F0;
    }

    .stats-tab {
      padding: 10px 20px;
      background: transparent;
      border: none;
      color: #718096;
      font-weight: 600;
      cursor: pointer;
      border-bottom: 3px solid transparent;
      transition: all 0.3s ease;
      font-family: 'Poppins', sans-serif;
    }

    .stats-tab.active {
      color: #667eea;
      border-bottom-color: #667eea;
    }

    .stats-tab:hover {
      color: #4A5568;
    }

    @media (max-width: 640px) {
      .stats-grid {
        grid-template-columns: 1fr;
      }

      .stat-number {
        font-size: 2rem;
      }

      .category-bar-label {
        min-width: 90px;
        font-size: 0.85rem;
      }
    }
  </style>
</head>

<body>
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useEffect } = React;

    const JARS = [
      {
        id: 'partner',
        name: 'Partner',
        icon: 'fa-solid fa-heart',
        colorLight: '#FF6B9D',
        colorMain: '#FF1493',
        colorDark: '#C71585',
        acts: [
          "Write a love note and hide it somewhere they'll find it",
          "Make their favorite breakfast in bed",
          "Give them an unexpected compliment about something specific",
          "Plan a surprise date night at home with candles",
          "Do one of their chores without being asked",
          "Send them a sweet text in the middle of the day",
          "Give them a 10-minute shoulder massage",
          "Listen to them talk about their day without interrupting",
          "Surprise them with their favorite snack or treat",
          "Hold their hand for no reason",
          "Tell them three things you appreciate about them",
          "Watch their favorite movie with them, even if you've seen it",
          "Make a playlist of songs that remind you of them",
          "Kiss them goodbye like it's the first time",
          "Give them your full attention for an hour (no phone)",
          "Remember and do something they mentioned wanting to do",
          "Take over a task they've been dreading",
          "Compliment them in front of others",
          "Plan a future adventure together",
          "Recreate your first date or a special memory",
          "Leave love notes in unexpected places for a week",
          "Cook their favorite meal from scratch",
          "Create a photo album or scrapbook of your memories together",
          "Plan a surprise picnic in a beautiful location",
          "Give them a day off - handle everything they usually do",
          "Write them a poem or song",
          "Recreate your first kiss",
          "Buy them flowers for no reason",
          "Plan a weekend getaway surprise",
          "Make a video montage of your relationship",
          "Learn their love language and use it intentionally today",
          "Give them a spa day at home",
          "Dance with them in the kitchen",
          "Tell them why you fell in love with them",
          "Support their biggest dream out loud",
          "Make a bucket list together",
          "Surprise them at work with lunch",
          "Create a tradition just for the two of you",
          "Tell them what you admire most about them",
          "Plan a stargazing date night"
        ]
      },
      {
        id: 'mother',
        name: 'Mother',
        icon: 'fa-solid fa-spa',
        colorLight: '#C9A0DC',
        colorMain: '#BA68C8',
        colorDark: '#9C27B0',
        acts: [
          "Call her just to say 'I love you'",
          "Send her flowers or a plant for no reason",
          "Offer to help with a task she's been putting off",
          "Cook her favorite meal",
          "Share a happy memory you have with her",
          "Thank her for something specific she did when you were younger",
          "Send her a heartfelt card or letter",
          "Plan a mother-daughter/son day doing something she loves",
          "Help her with technology (phone, computer, etc.)",
          "Give her a sincere compliment",
          "Ask for her advice about something",
          "Listen to her stories without rushing",
          "Offer to do her grocery shopping",
          "Take her out for lunch or coffee",
          "Help her organize or declutter something",
          "Frame a special photo for her",
          "Learn to make one of her signature recipes with her",
          "Surprise her with a visit if you live apart",
          "Tell her you're proud of her",
          "Simply spend quality time with her doing nothing special",
          "Create a memory book of her life stories",
          "Video call her if you're far away",
          "Plant flowers in her garden together",
          "Give her a handmade gift",
          "Take her to get her nails done",
          "Watch her favorite TV show together",
          "Ask about her childhood and really listen",
          "Help her with a home improvement project",
          "Bring her breakfast in bed",
          "Tell her a specific way she made your life better",
          "Give her a day of complete relaxation",
          "Create a playlist of her favorite songs",
          "Take her shopping and treat her to something special",
          "Write down her favorite recipes in her handwriting",
          "Ask her to teach you something she's good at",
          "Give her a photo session and frame the best ones",
          "Plan a family gathering in her honor",
          "Share an article or book you think she'd enjoy",
          "Tell her thank you for being your mom",
          "Make a donation to her favorite charity in her name"
        ]
      },
      {
        id: 'father',
        name: 'Father',
        icon: 'fa-solid fa-screwdriver-wrench',
        colorLight: '#64B5F6',
        colorMain: '#2196F3',
        colorDark: '#1976D2',
        acts: [
          "Call him just to hear his voice",
          "Ask him to teach you something he's skilled at",
          "Thank him for a sacrifice he made for you",
          "Watch a sports game or show he likes together",
          "Help him with a project around the house",
          "Share a proud moment in your life with him",
          "Ask about his childhood and really listen",
          "Take him out for his favorite meal",
          "Give him a sincere hug",
          "Tell him you appreciate his hard work",
          "Help him with yard work or car maintenance",
          "Learn about his hobbies and show genuine interest",
          "Send him a photo that will make him smile",
          "Ask for his advice on something important",
          "Spend quality time doing what he loves",
          "Tell him a specific way he influenced your life",
          "Share a joke or funny story with him",
          "Help him with technology he's struggling with",
          "Plan a father-son/daughter activity",
          "Thank him for being your dad",
          "Cook his favorite meal for him",
          "Give him a day to relax completely",
          "Ask about his dreams when he was younger",
          "Tell him you're proud to be his child",
          "Work on his car together",
          "Take him fishing or to do his favorite outdoor activity",
          "Frame a special photo of you two together",
          "Ask him about his father",
          "Learn one of his favorite songs on an instrument",
          "Help him organize his garage or workshop",
          "Surprise him with tickets to something he'd enjoy",
          "Make a video message telling him what he means to you",
          "Ask him to share his best life advice",
          "Give him a book on a topic he's interested in",
          "Spend a whole day with him doing his favorite things",
          "Tell him thank you for the values he taught you",
          "Ask him about his proudest moments",
          "Create a photo album of memories together",
          "Simply tell him 'I love you, Dad'",
          "Make him breakfast and let him sleep in"
        ]
      },
      {
        id: 'family',
        name: 'Family',
        icon: 'fa-solid fa-house',
        colorLight: '#FFD54F',
        colorMain: '#FFC107',
        colorDark: '#FFA000',
        acts: [
          "Organize a family game night",
          "Start a new family tradition",
          "Create a family group chat if you don't have one",
          "Share a favorite childhood memory with everyone",
          "Plan a surprise family gathering",
          "Make a family photo album or scrapbook",
          "Cook a meal together as a family",
          "Tell each family member something you appreciate about them",
          "Organize old family photos and share them digitally",
          "Plan a family movie night with everyone's favorites",
          "Start a family recipe book with everyone's contributions",
          "Surprise a family member with their favorite treat",
          "Mediate and help resolve a family conflict peacefully",
          "Create a family tree together",
          "Share funny family stories with the younger generation",
          "Organize a family video call if you're apart",
          "Plan a family picnic or outdoor day",
          "Help a family member with a task they're struggling with",
          "Send a group text celebrating someone's achievement",
          "Create a family time capsule",
          "Interview family elders and record their stories",
          "Surprise everyone with a family talent show",
          "Make a family playlist with everyone's song choices",
          "Organize a family charity project together",
          "Create family awards (funniest, kindest, etc.)",
          "Plan a family reunion or gathering",
          "Share what you're grateful for about your family",
          "Help younger family members with homework or skills",
          "Organize a family potluck dinner",
          "Create a family book club",
          "Plan surprise birthday celebrations together",
          "Start a family garden together",
          "Make matching family t-shirts or something fun",
          "Organize family sports day or activities",
          "Create a shared family calendar",
          "Help preserve family heirlooms or traditions",
          "Plan a family adventure or day trip",
          "Make a family music jam session",
          "Share your hopes and dreams with your family",
          "Tell your family how much they mean to you"
        ]
      },
      {
        id: 'friends',
        name: 'Friends',
        icon: 'fa-solid fa-user-group',
        colorLight: '#FF8A80',
        colorMain: '#FF5252',
        colorDark: '#FF1744',
        acts: [
          "Send a random 'thinking of you' text to a friend",
          "Plan a surprise hangout doing something they love",
          "Share a meme or joke that reminds you of them",
          "Be there for them when they need to vent",
          "Celebrate their wins, big or small",
          "Send them a care package or surprise gift",
          "Reach out to a friend you haven't talked to in a while",
          "Help them with something they're stressed about",
          "Plan a fun adventure together",
          "Tell them why you value their friendship",
          "Be a good listener without giving unsolicited advice",
          "Remember and acknowledge important dates in their life",
          "Introduce them to someone they might connect with",
          "Support their dreams and goals actively",
          "Create a playlist for them",
          "Share a book or show you think they'd love",
          "Organize a group hangout with mutual friends",
          "Help them move or with a big project",
          "Send them encouragement before a big event",
          "Make them laugh when they're feeling down",
          "Be honest with them when they need it",
          "Give them space when they need it",
          "Remember details from past conversations",
          "Plan a regular catch-up tradition (weekly coffee, etc.)",
          "Celebrate their birthday in a meaningful way",
          "Share your own vulnerabilities to deepen connection",
          "Take photos together to preserve memories",
          "Support their side hustle or passion project",
          "Give them a meaningful compliment",
          "Be present without your phone when together",
          "Surprise them at work with lunch or coffee",
          "Create inside jokes and keep them alive",
          "Defend them when they're not around",
          "Include them in your plans spontaneously",
          "Share something that made you think of them",
          "Help them through a tough breakup or life change",
          "Plan a trip together",
          "Tell them a specific way they've made your life better",
          "Be their cheerleader, always",
          "Simply say 'I'm grateful for our friendship'"
        ]
      },
      {
        id: 'colleagues',
        name: 'Colleagues',
        icon: 'fa-solid fa-briefcase',
        colorLight: '#9575CD',
        colorMain: '#673AB7',
        colorDark: '#512DA8',
        acts: [
          "Bring coffee or treats for the team",
          "Publicly acknowledge someone's hard work",
          "Help a colleague with a challenging task",
          "Share credit for team successes",
          "Mentor a junior colleague",
          "Send a thank you email to someone who helped you",
          "Offer to cover for someone who needs time off",
          "Include quieter voices in meetings",
          "Share useful resources or knowledge freely",
          "Celebrate work anniversaries and milestones",
          "Give genuine, specific compliments on work",
          "Help onboard a new team member warmly",
          "Organize a team lunch or coffee break",
          "Defend a colleague's idea in a meeting",
          "Offer constructive feedback kindly",
          "Share an opportunity that might benefit them",
          "Nominate someone for recognition or awards",
          "Be punctual and respectful of others' time",
          "Create a positive atmosphere in meetings",
          "Help someone learn a new skill",
          "Remember personal details and ask about them",
          "Support work-life balance for your team",
          "Volunteer to take on an unpopular task",
          "Listen to complaints without judgment",
          "Collaborate instead of compete",
          "Send a congratulations note for achievements",
          "Include everyone in team celebrations",
          "Share workload when someone is overwhelmed",
          "Give space for others to shine",
          "Be reliable and follow through on commitments",
          "Create documentation to help others",
          "Organize team-building activities",
          "Welcome diverse perspectives and ideas",
          "Help resolve conflicts professionally",
          "Send encouragement before big presentations",
          "Celebrate small wins, not just big ones",
          "Be a positive presence in the workplace",
          "Thank the support staff (cleaners, security, etc.)",
          "Respect boundaries and personal time",
          "Create a culture of kindness at work"
        ]
      },
      {
        id: 'strangers',
        name: 'Strangers',
        icon: 'fa-solid fa-earth-americas',
        colorLight: '#80DEEA',
        colorMain: '#26C6DA',
        colorDark: '#00ACC1',
        acts: [
          "Compliment someone genuinely (outfit, smile, etc.)",
          "Hold the door open for people behind you",
          "Let someone go ahead of you in line",
          "Smile and make eye contact with passersby",
          "Leave a generous tip for great service",
          "Help someone carry heavy bags or packages",
          "Give up your seat on public transport",
          "Pay for the person behind you in the coffee line",
          "Leave a kind note in a library book",
          "Pick up litter you see on the street",
          "Give directions with patience and kindness",
          "Say thank you to service workers (cashiers, drivers, etc.)",
          "Leave quarters in vending machines",
          "Help someone who looks lost",
          "Donate items to a charity shop",
          "Return a shopping cart for someone",
          "Leave a positive online review for a local business",
          "Donate blood or sign up to be an organ donor",
          "Give your umbrella to someone in the rain",
          "Leave encouraging notes in random places",
          "Offer your phone charger to someone in need",
          "Help a parent struggling with kids/stroller",
          "Shovel snow for a neighbor or elderly person",
          "Leave a care package for a homeless person",
          "Teach someone something useful",
          "Be patient with someone learning English",
          "Wave to kids looking out of car windows",
          "Thank a veteran for their service",
          "Leave extra change in a parking meter",
          "Offer to take a photo for tourists",
          "Help someone reach something on a high shelf",
          "Give your spot in line to someone in a hurry",
          "Send an anonymous gift to someone who needs it",
          "Volunteer at a local shelter or food bank",
          "Write thank you notes to essential workers",
          "Be kind to telemarketers (they're people too)",
          "Offer help before being asked",
          "Share your expertise freely when asked",
          "Welcome new neighbors with a small gift",
          "Simply spread positivity wherever you go"
        ]
      },
      {
        id: 'nature',
        name: 'Nature',
        icon: 'fa-solid fa-seedling',
        colorLight: '#81C784',
        colorMain: '#4CAF50',
        colorDark: '#388E3C',
        acts: [
          "Pick up litter in a park or natural area",
          "Plant a tree or flowers in your community",
          "Create a bird feeder or bird bath",
          "Avoid single-use plastics today",
          "Support environmental organizations",
          "Start composting food scraps",
          "Use reusable bags, bottles, and containers",
          "Reduce water usage (shorter showers, etc.)",
          "Switch to energy-efficient light bulbs",
          "Walk or bike instead of driving today",
          "Create a wildlife-friendly garden space",
          "Learn about local endangered species",
          "Participate in a beach or park cleanup",
          "Buy from sustainable and eco-friendly brands",
          "Reduce meat consumption for a day or week",
          "Share environmental tips with friends",
          "Turn off lights and electronics when not in use",
          "Support local farmers markets",
          "Create habitats for beneficial insects",
          "Educate others about climate change",
          "Plant native species in your garden",
          "Fix leaky faucets to conserve water",
          "Recycle and learn proper recycling methods",
          "Use natural cleaning products",
          "Create a rain garden or install rain barrels",
          "Support renewable energy initiatives",
          "Reduce, reuse, recycle in that order",
          "Leave no trace when hiking or camping",
          "Build a bee hotel or insect house",
          "Choose products with minimal packaging",
          "Hang clothes to dry instead of using dryer",
          "Support conservation efforts financially",
          "Create a community garden",
          "Avoid pesticides and herbicides",
          "Preserve green spaces in your community",
          "Learn to identify local plants and animals",
          "Share produce from your garden",
          "Take eco-friendly transportation",
          "Spread awareness about environmental issues",
          "Spend time in nature and appreciate its beauty"
        ]
      },
      {
        id: 'pets',
        name: 'Pets',
        icon: 'fa-solid fa-paw',
        colorLight: '#F48FB1',
        colorMain: '#EC407A',
        colorDark: '#D81B60',
        acts: [
          "Give your pet extra playtime today",
          "Surprise them with a new toy or treat",
          "Take them on a longer walk or adventure",
          "Brush or groom them lovingly",
          "Create a comfortable new sleeping spot",
          "Learn a new trick together through positive training",
          "Have a special photoshoot with your pet",
          "Make homemade treats for them",
          "Clean and organize their toys and belongings",
          "Give them your undivided attention for an hour",
          "Take them to their favorite park or spot",
          "Schedule and attend a vet checkup",
          "Update their ID tags and microchip info",
          "Create a pet Instagram to document memories",
          "Donate to an animal shelter in their honor",
          "Set up a play date with another pet",
          "Make a cozy window perch for them",
          "Try a new activity together (agility, swimming, etc.)",
          "Upgrade their food or water bowls",
          "Give them a gentle massage",
          "Take them on a car ride to somewhere fun",
          "Create a special meal or 'pupcake' for them",
          "Spend time just cuddling together",
          "Build or buy them new furniture (cat tree, dog bed)",
          "Take them to a pet-friendly cafe or store",
          "Learn more about their breed or species needs",
          "Create a safe outdoor space for them",
          "Volunteer at an animal shelter",
          "Foster an animal in need",
          "Teach them something new",
          "Get them a cozy sweater or outfit for cold weather",
          "Set up a treasure hunt with treats",
          "Give them a spa day (bath, nail trim, etc.)",
          "Rotate their toys to keep things interesting",
          "Create an obstacle course for them",
          "Take them to meet new friendly people or pets",
          "Invest in their health with supplements or insurance",
          "Make a scrapbook of your time together",
          "Tell them how much you love them",
          "Appreciate them for the joy they bring to your life"
        ]
      },
      {
        id: 'selfcare',
        name: 'Self-Care',
        icon: 'fa-solid fa-heart-pulse',
        colorLight: '#4DD0E1',
        colorMain: '#00BCD4',
        colorDark: '#0097A7',
        acts: [
          "Take a relaxing bath with candles and music",
          "Go to bed 30 minutes earlier tonight",
          "Drink 8 glasses of water today",
          "Do a face mask or spa treatment at home",
          "Take a walk outside without your phone",
          "Write in a gratitude journal",
          "Say no to something that drains your energy",
          "Prepare a healthy, nourishing meal for yourself",
          "Meditate for 10 minutes",
          "Stretch or do gentle yoga",
          "Read a book just for pleasure",
          "Listen to your favorite music loudly",
          "Take a break from social media for the day",
          "Watch the sunrise or sunset mindfully",
          "Forgive yourself for a past mistake",
          "Get a massage or book a spa treatment",
          "Clean and organize your living space",
          "Buy yourself flowers or a plant",
          "Have a digital detox evening",
          "Practice positive affirmations",
          "Do absolutely nothing guilt-free for an hour",
          "Call a therapist or counselor if needed",
          "Pamper yourself with a new skincare routine",
          "Dance freely to music you love",
          "Take yourself on a solo date",
          "Create art, write, or express yourself creatively",
          "Get 8+ hours of sleep tonight",
          "Declutter one area that stresses you",
          "Try a new hobby you've been curious about",
          "Set a healthy boundary with someone",
          "Treat yourself to something special",
          "Practice deep breathing exercises",
          "Spend time in nature",
          "Watch a movie that makes you happy",
          "Journal your thoughts and feelings",
          "Exercise in a way that feels good",
          "Eat your favorite comfort food mindfully",
          "Look in the mirror and say kind things to yourself",
          "Rest without feeling guilty about it",
          "Celebrate yourself for making it this far"
        ]
      }
    ];

    // Theme Configurations
    const THEMES = {
      classic: {
        name: 'Classic',
        colors: {
          background: 'linear-gradient(135deg, #E0F2FE 0%, #FFF5F0 50%, #FFE4E6 100%)',
          title: 'linear-gradient(135deg, #7C3AED 0%, #DB2777 100%)',
          subtitle: '#64748B',
          buttonBg: 'rgba(255, 255, 255, 0.9)',
          buttonHover: 'white',
          selectText: '#1E293B'
        },
        fonts: {
          title: 'Caveat',
          subtitle: 'Poppins',
          body: 'Poppins'
        },
        messaging: {
          title: 'KINDNESS JAR',
          subtitle: 'Spread Love & Joy Every Single Day!',
          completePrefix: '',
          completeSuffix: ' ‚ú®'
        },
        transformAct: (act) => act
      },
      dude: {
        name: 'Dude Mode',
        colors: {
          background: 'linear-gradient(135deg, #0F172A 0%, #1E293B 50%, #334155 100%)',
          title: 'linear-gradient(135deg, #FB923C 0%, #F97316 100%)',
          subtitle: '#CBD5E1',
          buttonBg: 'rgba(255, 255, 255, 0.95)',
          buttonHover: 'rgba(255, 255, 255, 1)',
          selectText: '#1E293B'
        },
        fonts: {
          title: 'Impact, Arial Black',
          subtitle: 'Arial',
          body: 'Arial'
        },
        messaging: {
          title: 'KINDNESS JAR',
          subtitle: 'Real Kiwi Blokes Do Kind Stuff. Choice!',
          completePrefix: 'SWEET AS BRO! ',
          completeSuffix: ' üî•ü§ô'
        },
        transformAct: (act) => {
          // Contextual Kiwi slang based on act content
          const actLower = act.toLowerCase();

          // Detect context from keywords
          const isFamily = /family|dad|mum|parent|kid|child|wife|husband|partner/.test(actLower);
          const isFriend = /friend|mate|buddy|pal/.test(actLower);
          const isWork = /work|colleague|boss|coworker|team/.test(actLower);
          const isHelp = /help|assist|support|lend/.test(actLower);
          const isComm = /text|call|message|ring|chat|talk/.test(actLower);
          const isGift = /gift|buy|treat|surprise/.test(actLower);
          const isAction = /do |make |fix |clean |cook |build/.test(actLower);

          // Context-specific slang patterns
          let patterns = [];

          if (isFamily) {
            patterns = [
              `Oi mate, {act} - family first, bro!`,
              `Listen up: {act}. Your whanau needs you, legend!`,
              `Chur bro, {act} - that's what family's for!`,
              `Ay bro: {act}. Look after your mob, mate!`,
              `Mate, {act} - show your lot some love!`
            ];
          } else if (isFriend) {
            patterns = [
              `Bro, {act} - mates look out for mates, eh!`,
              `Chur: {act}, legend! Good mates are choice!`,
              `Oi, {act} - that's what bros are for!`,
              `Mate: {act}. Solid gold friendship right there!`,
              `Ay bro, {act} - your mates will appreciate that!`
            ];
          } else if (isWork) {
            patterns = [
              `Listen legend: {act}. Team work makes the dream work!`,
              `Bro, {act} - be a good team player, eh!`,
              `Mate: {act}. Help out your work mates!`,
              `Chur: {act} - that's how you earn respect at work!`,
              `Oi: {act}, it'll make work heaps better!`
            ];
          } else if (isHelp) {
            patterns = [
              `Mate, {act} - lend a hand, that's the Kiwi way!`,
              `Bro: {act}. She'll be right, just help out!`,
              `Chur bro, {act} - be a legend and pitch in!`,
              `Ay mate: {act}. Everyone needs help sometimes!`,
              `Oi: {act} - that's being a good bugger!`
            ];
          } else if (isComm) {
            patterns = [
              `Bro: {act} - stay connected, mate!`,
              `Chur: {act}. Reach out, it means heaps!`,
              `Mate, {act} - keep in touch, legend!`,
              `Oi: {act}, they'll appreciate hearing from you!`,
              `Ay bro: {act} - communication is key!`
            ];
          } else if (isGift) {
            patterns = [
              `Mate: {act} - show some aroha, bro!`,
              `Chur: {act}. Thoughtful gifts are choice!`,
              `Bro, {act} - spread the love!`,
              `Oi: {act}, mate! Everyone loves a good surprise!`,
              `Legend: {act} - that's being generous!`
            ];
          } else if (isAction) {
            patterns = [
              `Mate: {act} - get stuck in and do it!`,
              `Bro, {act} - action speaks louder than words!`,
              `Chur: {act}. Just do it, no worries!`,
              `Ay: {act} - that's taking initiative, legend!`,
              `Oi mate: {act}, she'll be right!`
            ];
          } else {
            // General varied patterns
            patterns = [
              `Mate, {act} - good on ya!`,
              `Bro: {act}. Too easy!`,
              `Chur bro: {act}, legend!`,
              `Oi mate, {act} - sweet as!`,
              `Listen up: {act} - that's choice!`,
              `Ay bro, {act} - you beauty!`,
              `Mate: {act}. Mint!`,
              `Bro, {act} - hard case!`,
              `Chur: {act}, that's the ticket!`,
              `Oi: {act} - she'll be right!`
            ];
          }

          // Pick random pattern and replace {act}
          const pattern = patterns[Math.floor(Math.random() * patterns.length)];
          return pattern.replace('{act}', actLower);
        }
      },
      gay: {
        name: 'Fabulous Mode',
        colors: {
          background: 'linear-gradient(135deg, #FF0080 0%, #7928CA 25%, #4D7CFF 50%, #00DFD8 75%, #FF0080 100%)',
          title: 'linear-gradient(135deg, #FFD700 0%, #FF1493 50%, #9370DB 100%)',
          subtitle: '#FFFFFF',
          buttonBg: 'rgba(255, 255, 255, 0.95)',
          buttonHover: 'rgba(255, 255, 255, 1)',
          selectText: '#1E293B'
        },
        fonts: {
          title: 'Pacifico',
          subtitle: 'Poppins',
          body: 'Poppins'
        },
        messaging: {
          title: 'KINDNESS JAR',
          subtitle: 'Serving Kindness Realness, Hunty!',
          completePrefix: 'SLAY! ',
          completeSuffix: ' üíÖ‚ú®üåà'
        },
        transformAct: (act) => {
          // Add fabulous gay language
          const fabulousStarters = [
            "Hunty, ",
            "Yaaas queen! ",
            "Slay: ",
            "Fierce! ",
            "Werk it: "
          ];
          const fabulousEnders = [
            ", and make it FIERCE!",
            " - serving LOOKS!",
            " like the icon you are!",
            " - absolutely STUNNING!",
            ", babe!"
          ];
          const starter = fabulousStarters[Math.floor(Math.random() * fabulousStarters.length)];
          const ender = fabulousEnders[Math.floor(Math.random() * fabulousEnders.length)];
          return starter + act.toLowerCase() + ender;
        }
      },
      goth: {
        name: 'Goth Mode',
        colors: {
          background: 'linear-gradient(135deg, #0a0a0a 0%, #1a0a1a 25%, #2d1b2e 50%, #1a0a1a 75%, #0a0a0a 100%)',
          title: 'linear-gradient(135deg, #8B0000 0%, #4B0082 50%, #000000 100%)',
          subtitle: '#9B9B9B',
          buttonBg: 'rgba(30, 30, 30, 0.95)',
          buttonHover: 'rgba(50, 30, 50, 1)',
          selectText: '#E0E0E0'
        },
        fonts: {
          title: 'Georgia, serif',
          subtitle: 'Times New Roman, serif',
          body: 'Georgia, serif'
        },
        messaging: {
          title: 'KINDNESS JAR',
          subtitle: 'Embrace the Light Within the Shadows...',
          completePrefix: 'Well done, dark soul... ',
          completeSuffix: ' üñ§‚ö∞Ô∏è'
        },
        transformAct: (act) => {
          // Add gothic/dark language
          const gothStarters = [
            "In the darkness, ",
            "From the shadows: ",
            "Hear this, creature of the night: ",
            "Dark one, ",
            "Through the veil: ",
            "Heed this call: "
          ];
          const gothEnders = [
            "...and find light in the void.",
            " - even darkness can be kind.",
            "...let kindness be your curse.",
            " - beauty blooms in shadows.",
            "...darkness embraces all.",
            " - a gift from the abyss."
          ];
          const starter = gothStarters[Math.floor(Math.random() * gothStarters.length)];
          const ender = gothEnders[Math.floor(Math.random() * gothEnders.length)];
          return starter + act.toLowerCase() + ender;
        }
      },
      neutral: {
        name: 'Neutral',
        colors: {
          background: 'linear-gradient(135deg, #F8FAFC 0%, #E2E8F0 50%, #CBD5E1 100%)',
          title: 'linear-gradient(135deg, #0F172A 0%, #334155 100%)',
          subtitle: '#475569',
          buttonBg: 'rgba(255, 255, 255, 0.95)',
          buttonHover: 'white',
          selectText: '#1E293B'
        },
        fonts: {
          title: 'Poppins',
          subtitle: 'Poppins',
          body: 'Poppins'
        },
        messaging: {
          title: 'KINDNESS JAR',
          subtitle: 'Make Every Day Count with Small Acts',
          completePrefix: 'Well done! ',
          completeSuffix: ' ‚úì'
        },
        transformAct: (act) => act
      }
    };

    function App() {
      const [selectedJar, setSelectedJar] = useState(null);
      const [currentAct, setCurrentAct] = useState(null);
      const [isAIGenerated, setIsAIGenerated] = useState(false);
      const [wiggleJar, setWiggleJar] = useState(null);
      const [completedActs, setCompletedActs] = useState([]);
      const [showStats, setShowStats] = useState(false);
      const [showCelebration, setShowCelebration] = useState(false);
      const [showDonation, setShowDonation] = useState(false);
      const [isGenerating, setIsGenerating] = useState(false);
      const [donationAmount, setDonationAmount] = useState(5);
      const [customImages, setCustomImages] = useState({});
      const [editingJar, setEditingJar] = useState(null);
      const [previewImage, setPreviewImage] = useState(null);
      const [statsTab, setStatsTab] = useState('overview');
      const [isMobile, setIsMobile] = useState(window.innerWidth <= 640);
      const [deferredPrompt, setDeferredPrompt] = useState(null);
      const [showInstallButton, setShowInstallButton] = useState(false);
      // Detect mobile viewport changes
      useEffect(() => {
        const handleResize = () => {
          setIsMobile(window.innerWidth <= 640);
        };

        window.addEventListener('resize', handleResize);
        return () => window.removeEventListener('resize', handleResize);
      }, []);

      // Listen for PWA install prompt
      useEffect(() => {
        const handleBeforeInstallPrompt = (e) => {
          // Prevent the mini-infobar from appearing on mobile
          e.preventDefault();
          // Store the event so it can be triggered later
          setDeferredPrompt(e);
          // Show our custom install button
          setShowInstallButton(true);
        };

        window.addEventListener('beforeinstallprompt', handleBeforeInstallPrompt);

        return () => {
          window.removeEventListener('beforeinstallprompt', handleBeforeInstallPrompt);
        };
      }, []);

      useEffect(() => {
        const saved = localStorage.getItem('kindnessJar_completedActs');
        if (saved) {
          setCompletedActs(JSON.parse(saved));
        }

        const savedImages = localStorage.getItem('kindnessJar_customImages');
        if (savedImages) {
          setCustomImages(JSON.parse(savedImages));
        }
      }, []);

      useEffect(() => {
        localStorage.setItem('kindnessJar_completedActs', JSON.stringify(completedActs));
      }, [completedActs]);

      useEffect(() => {
        localStorage.setItem('kindnessJar_customImages', JSON.stringify(customImages));
      }, [customImages]);

      useEffect(() => {
        const urlParams = new URLSearchParams(window.location.search);
        const success = urlParams.get('success');
        const canceled = urlParams.get('canceled');
        const amount = urlParams.get('amount');

        if (success) {
          const dollars = (parseInt(amount) / 100).toFixed(2);
          alert(`üéâ Thank you for your $${dollars} donation! You're amazing! üíñ`);
          window.history.replaceState({}, document.title, window.location.pathname);
        }

        if (canceled) {
          alert('Donation was canceled. No worries, you can try again anytime! üòä');
          window.history.replaceState({}, document.title, window.location.pathname);
        }
      }, []);

      const handleJarClick = (jar) => {
        setWiggleJar(jar.id);
        setTimeout(() => setWiggleJar(null), 700);

        const randomAct = jar.acts[Math.floor(Math.random() * jar.acts.length)];

        setTimeout(() => {
          setSelectedJar(jar);
          setCurrentAct(randomAct);
          setIsAIGenerated(false);
        }, 300);
      };

      const handleInstallClick = async () => {
        if (!deferredPrompt) {
          return;
        }

        // Show the install prompt
        deferredPrompt.prompt();

        // Wait for the user to respond to the prompt
        const { outcome } = await deferredPrompt.userChoice;

        if (outcome === 'accepted') {
          console.log('User accepted the install prompt');
        } else {
          console.log('User dismissed the install prompt');
        }

        // Clear the deferred prompt
        setDeferredPrompt(null);
        setShowInstallButton(false);
      };

      const handleGenerateAI = async () => {
        // AI generation requires backend setup
        // For now, generate a random act from the existing pool
        setIsGenerating(true);

        setTimeout(() => {
          const randomAct = selectedJar.acts[Math.floor(Math.random() * selectedJar.acts.length)];
          setCurrentAct(randomAct);
          setIsAIGenerated(false);
          setIsGenerating(false);
        }, 800);

        // To enable true AI generation:
        // 1. Set up backend server (see STRIPE-SETUP-GUIDE)
        // 2. Create endpoint: POST /generate-kindness
        // 3. Backend calls Anthropic API with your API key
        // 4. Replace above code with fetch to your backend
      };

      const handleComplete = () => {
        const newAct = {
          id: Date.now().toString(),
          category: selectedJar.id,
          categoryName: selectedJar.name,
          act: currentAct,
          isAI: isAIGenerated,
          completedAt: new Date().toISOString(),
          date: new Date().toISOString().split('T')[0]
        };

        setCompletedActs([...completedActs, newAct]);
        setShowCelebration(true);
        createConfetti();

        setTimeout(() => setShowCelebration(false), 1000);
        setTimeout(() => {
          setSelectedJar(null);
          setCurrentAct(null);
          setIsAIGenerated(false);
        }, 1200);
      };

      const createConfetti = () => {
        const colors = ['#FF6B6B', '#4ECDC4', '#45B7D1', '#FFA07A', '#98D8C8', '#F7DC6F', '#BB8FCE', '#85C1E2'];
        const shapes = ['‚óè', '‚ñ†', '‚ñ≤', '‚òÖ', '‚ô•'];

        for (let i = 0; i < 80; i++) {
          setTimeout(() => {
            const confetti = document.createElement('div');
            confetti.className = 'confetti';
            confetti.textContent = shapes[Math.floor(Math.random() * shapes.length)];
            confetti.style.left = Math.random() * 100 + '%';
            confetti.style.color = colors[Math.floor(Math.random() * colors.length)];
            confetti.style.setProperty('--x', (Math.random() - 0.5) * 200 + 'px');
            confetti.style.fontSize = (Math.random() * 15 + 10) + 'px';
            document.body.appendChild(confetti);
            setTimeout(() => confetti.remove(), 3000);
          }, i * 15);
        }
      };

      const handleDonate = async () => {
        try {
          // Configuration - Update these values for your deployment
          const STRIPE_PUBLISHABLE_KEY = 'pk_live_51StH5DPk6Kx4nhlg0h7YzsInIPULprlSHOlbVYZ5tqzXK14y9c6OAvQVdfYiUKy0tthpJbmYH912KOpHY84wDUgY00wzxNvxVA'; // Your Stripe publishable key
          const BACKEND_URL = window.location.hostname === 'localhost'
            ? 'http://localhost:3000'
            : 'https://kindness-jar.onrender.com'; // Production backend URL

          // Initialize Stripe
          const stripe = Stripe(STRIPE_PUBLISHABLE_KEY);

          // Show loading state (you could update button text here if needed)
          console.log('Creating checkout session...');

          // Call backend to create checkout session
          const response = await fetch(`${BACKEND_URL}/create-checkout-session`, {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
            },
            body: JSON.stringify({
              amount: donationAmount * 100, // Convert dollars to cents
            }),
          });

          if (!response.ok) {
            throw new Error('Failed to create checkout session');
          }

          const session = await response.json();

          // Redirect to Stripe Checkout
          const result = await stripe.redirectToCheckout({
            sessionId: session.id,
          });

          if (result.error) {
            alert(result.error.message);
          }
        } catch (error) {
          console.error('Payment error:', error);
          alert('Something went wrong with the payment. Please try again or contact support.');
        }
      };

      // Analytics Functions
      const calculateStreak = () => {
        if (completedActs.length === 0) return 0;

        const dates = [...new Set(completedActs.map(a => a.date))].sort().reverse();
        const today = new Date().toISOString().split('T')[0];
        let streak = 0;

        for (let i = 0; i < dates.length; i++) {
          const expectedDate = new Date();
          expectedDate.setDate(expectedDate.getDate() - streak);
          const expected = expectedDate.toISOString().split('T')[0];

          if (dates[i] === expected) {
            streak++;
          } else {
            break;
          }
        }

        return streak;
      };

      const getLast7Days = () => {
        const last7Days = [];
        const dayNames = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];

        for (let i = 6; i >= 0; i--) {
          const date = new Date();
          date.setDate(date.getDate() - i);
          const dateStr = date.toISOString().split('T')[0];
          const count = completedActs.filter(act => act.date === dateStr).length;

          last7Days.push({
            date: dateStr,
            day: dayNames[date.getDay()],
            count: count
          });
        }

        return last7Days;
      };

      const getMostActiveCategory = () => {
        if (completedActs.length === 0) return null;

        const counts = {};
        completedActs.forEach(act => {
          counts[act.category] = (counts[act.category] || 0) + 1;
        });

        const maxCount = Math.max(...Object.values(counts));
        const mostActive = Object.keys(counts).find(key => counts[key] === maxCount);
        const jar = JARS.find(j => j.id === mostActive);

        return { jar, count: maxCount };
      };

      const getAveragePerDay = () => {
        if (completedActs.length === 0) return 0;

        const dates = [...new Set(completedActs.map(a => a.date))];
        const daysSinceFirst = dates.length;

        return (completedActs.length / daysSinceFirst).toFixed(1);
      };

      const getCategoryBreakdown = () => {
        const breakdown = JARS.map(jar => {
          const count = completedActs.filter(act => act.category === jar.id).length;
          return { jar, count };
        }).filter(item => item.count > 0)
          .sort((a, b) => b.count - a.count);

        return breakdown;
      };

      const getBestDayOfWeek = () => {
        if (completedActs.length === 0) return null;

        const dayNames = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];
        const dayCounts = [0, 0, 0, 0, 0, 0, 0];

        completedActs.forEach(act => {
          const date = new Date(act.date);
          dayCounts[date.getDay()]++;
        });

        const maxCount = Math.max(...dayCounts);
        const bestDay = dayCounts.indexOf(maxCount);

        return { day: dayNames[bestDay], count: maxCount };
      };

      const getInsights = () => {
        const insights = [];
        const streak = calculateStreak();
        const mostActive = getMostActiveCategory();
        const bestDay = getBestDayOfWeek();
        const total = completedActs.length;

        // Streak insights
        if (streak >= 7) {
          insights.push({
            type: 'success',
            icon: 'üî•',
            text: `Amazing! You're on a ${streak}-day streak! Keep the kindness flowing!`
          });
        } else if (streak >= 3) {
          insights.push({
            type: 'success',
            icon: '‚≠ê',
            text: `Great work! ${streak} days in a row. You're building a beautiful habit!`
          });
        }

        // Milestone insights
        if (total >= 100) {
          insights.push({
            type: 'success',
            icon: 'fa-solid fa-user-group',
            text: `Incredible! You've completed ${total} acts of kindness. You're truly making a difference!`
          });
        } else if (total >= 50) {
          insights.push({
            type: 'success',
            icon: 'üåü',
            text: `Halfway to 100! You've completed ${total} acts. Keep spreading love!`
          });
        } else if (total >= 10) {
          insights.push({
            type: 'info',
            icon: 'üí™',
            text: `You're getting started! ${total} acts completed. Every small act matters!`
          });
        }

        // Category insights
        if (mostActive && mostActive.count >= 5) {
          insights.push({
            type: 'info',
            icon: mostActive.jar.icon,
            text: `You're especially kind to ${mostActive.jar.name.toLowerCase()}! ${mostActive.count} acts in this category.`
          });
        }

        // Day of week insight
        if (bestDay && total >= 7) {
          insights.push({
            type: 'info',
            icon: 'üìÖ',
            text: `${bestDay.day} is your most active day! You've completed ${bestDay.count} acts on ${bestDay.day}s.`
          });
        }

        // Encouragement for new users
        if (total === 0) {
          insights.push({
            type: 'info',
            icon: 'fa-solid fa-seedling',
            text: `Ready to start your kindness journey? Click any jar above to begin spreading love!`
          });
        }

        return insights;
      };

      const handleEditImage = (jar, e) => {
        e.stopPropagation();
        setEditingJar(jar);
        setPreviewImage(customImages[jar.id] || null);
      };

      const handleImageUpload = (e) => {
        const file = e.target.files[0];
        if (!file) return;

        // Check file size (max 2MB)
        if (file.size > 2 * 1024 * 1024) {
          alert('Image too large! Please choose an image under 2MB.');
          return;
        }

        // Check file type
        if (!file.type.startsWith('image/')) {
          alert('Please select an image file.');
          return;
        }

        const reader = new FileReader();
        reader.onload = (event) => {
          const base64Image = event.target.result;
          setPreviewImage(base64Image);
        };
        reader.readAsDataURL(file);
      };

      const handleSaveImage = () => {
        if (previewImage) {
          setCustomImages({
            ...customImages,
            [editingJar.id]: previewImage
          });
        }
        setEditingJar(null);
        setPreviewImage(null);
      };

      const handleRemoveImage = () => {
        const newImages = { ...customImages };
        delete newImages[editingJar.id];
        setCustomImages(newImages);
        setPreviewImage(null);
      };

      const handleCancelEdit = () => {
        setEditingJar(null);
        setPreviewImage(null);
      };

      // Helper function to render a single jar
      const renderJar = (jar) => (
        <div
          key={jar.id}
          className="jar-item"
          onClick={() => handleJarClick(jar)}
        >
          <div className={`jar-container ${wiggleJar === jar.id ? 'wiggle' : ''}`}>
            <button
              className="jar-edit-button"
              onClick={(e) => handleEditImage(jar, e)}
              title="Customize icon"
            >
              ‚úèÔ∏è
            </button>
            <div className="jar">
              <div className="jar-lid"></div>
              <div
                className="jar-body"
                style={{
                  '--jar-color-light': jar.colorLight,
                  '--jar-color-main': jar.colorMain,
                  '--jar-color-dark': jar.colorDark
                }}
              >
                <div className="jar-inner-glow"></div>
                <div className="jar-edge-highlight"></div>
                <div className="jar-bottom-curve"></div>
                <div className={`jar-icon ${customImages[jar.id] ? 'has-custom-image' : ''}`}>
                  {customImages[jar.id] ? (
                    <img src={customImages[jar.id]} alt={jar.name} className="custom-image-icon" />
                  ) : (
                    <i className={jar.icon}></i>
                  )}
                </div>
                <div className="jar-label-sticker">
                  {jar.name}
                </div>
              </div>
              <div className="jar-shadow"></div>
            </div>
          </div>
        </div>
      );

      // Helper function to render jars with shelves in mobile view
      const renderJarsWithShelves = (jars) => {
        if (!isMobile) {
          // Desktop: render all jars normally
          return jars.map(jar => renderJar(jar));
        }

        // Mobile: insert shelf after every 2 jars
        const elements = [];
        jars.forEach((jar, index) => {
          elements.push(renderJar(jar));

          // Add shelf after every 2nd jar (but not after the last jar)
          if ((index + 1) % 2 === 0 && index < jars.length - 1) {
            elements.push(
              <div key={`shelf-${jar.id}`} className="mobile-shelf"></div>
            );
          }
        });

        return elements;
      };

      return (
        <div className="app-container">
          <div className="app-header">
            <img src="images/kindness-jar-title.png" alt="Kindness Jar" style={{maxWidth: '600px', width: '90%', height: 'auto', marginBottom: '20px'}} />
            <p className="app-subtitle">Spread Love & Joy Every Single Day!</p>

            <div className="button-row">
              {showInstallButton && (
                <button className="header-button install" onClick={handleInstallClick}>
                  üì± Install App
                </button>
              )}
              <button className="header-button" onClick={() => setShowStats(true)}>
                üìä My Impact
              </button>
              <button className="header-button donate" onClick={() => setShowDonation(true)}>
                üíù Support This App
              </button>
            </div>
          </div>

          <div className="shelf-container">
            {isMobile ? (
              // Mobile: Single grid with all jars and shelves between rows
              <div className="shelf">
                <div className="jar-grid">
                  {renderJarsWithShelves(JARS)}
                </div>
              </div>
            ) : (
              // Desktop: Two shelves with 5 jars each
              <>
                <div className="shelf">
                  <div className="jar-grid">
                    {renderJarsWithShelves(JARS.slice(0, 5))}
                  </div>
                </div>

                <div className="shelf">
                  <div className="jar-grid">
                    {renderJarsWithShelves(JARS.slice(5, 10))}
                  </div>
                </div>
              </>
            )}
          </div>

          {selectedJar && currentAct && (
            <div className="note-overlay" onClick={(e) => {
              if (e.target.className === 'note-overlay') {
                setSelectedJar(null);
                setCurrentAct(null);
                setIsAIGenerated(false);
              }
            }}>
              <div className="note-card">
                <div className="note-icon"><i className={selectedJar.icon}></i></div>
                <div className="note-category">{selectedJar.name}</div>
                <div className="note-title">Your Act of Kindness</div>
                <div className="note-text">{currentAct}</div>
                <div className="note-buttons">
                  <button className="note-button primary" onClick={handleComplete}>
                    ‚úì I Did It!
                  </button>
                  <button className="note-button secondary" onClick={() => {
                    const randomAct = selectedJar.acts[Math.floor(Math.random() * selectedJar.acts.length)];
                    setCurrentAct(randomAct);
                    setIsAIGenerated(false);
                  }}>
                    ‚Üª Show Another
                  </button>
                  <button
                    className="note-button ai"
                    onClick={handleGenerateAI}
                    disabled={isGenerating}
                  >
                    {isGenerating ? (
                      <><span className="loading-spinner"></span>Getting New Act...</>
                    ) : (
                      '‚Üª Get Random Act'
                    )}
                  </button>
                  <button className="note-button tertiary" onClick={() => {
                    setSelectedJar(null);
                    setCurrentAct(null);
                    setIsAIGenerated(false);
                  }}>
                    ‚Üê Back
                  </button>
                </div>
              </div>
            </div>
          )}

          {showCelebration && (
            <div className="completed-animation">
              <div className="completed-check">‚úì</div>
            </div>
          )}

          {showStats && (
            <div className="note-overlay" onClick={(e) => {
              if (e.target.className === 'note-overlay') setShowStats(false);
            }}>
              <div className="note-card" style={{ maxWidth: '650px' }}>
                <div className="note-icon">üìä</div>
                <div className="note-category">YOUR IMPACT</div>
                <div className="note-title">Kindness Analytics</div>

                {completedActs.length > 0 ? (
                  <>
                    {/* Tabs */}
                    <div className="stats-tabs">
                      <button
                        className={`stats-tab ${statsTab === 'overview' ? 'active' : ''}`}
                        onClick={() => setStatsTab('overview')}
                      >
                        Overview
                      </button>
                      <button
                        className={`stats-tab ${statsTab === 'trends' ? 'active' : ''}`}
                        onClick={() => setStatsTab('trends')}
                      >
                        Trends
                      </button>
                      <button
                        className={`stats-tab ${statsTab === 'insights' ? 'active' : ''}`}
                        onClick={() => setStatsTab('insights')}
                      >
                        Insights
                      </button>
                    </div>

                    {/* Overview Tab */}
                    {statsTab === 'overview' && (
                      <>
                        {/* Key Stats Grid */}
                        <div className="stats-grid">
                          <div className="stat-card">
                            <div className="stat-number">{completedActs.length}</div>
                            <div className="stat-label">Total Acts</div>
                          </div>
                          <div className="stat-card green">
                            <div className="stat-number">{calculateStreak()}</div>
                            <div className="stat-label">Day Streak üî•</div>
                          </div>
                          <div className="stat-card orange">
                            <div className="stat-number">{getAveragePerDay()}</div>
                            <div className="stat-label">Per Day Avg</div>
                          </div>
                          <div className="stat-card blue">
                            <div className="stat-number">{[...new Set(completedActs.map(a => a.date))].length}</div>
                            <div className="stat-label">Active Days</div>
                          </div>
                        </div>

                        {/* Category Breakdown with Bar Chart */}
                        <div className="stats-section">
                          <div style={{
                            fontSize: '0.9rem',
                            fontWeight: '600',
                            color: '#4A5568',
                            marginBottom: '15px',
                            textTransform: 'uppercase',
                            letterSpacing: '1px',
                            display: 'flex',
                            alignItems: 'center',
                            gap: '8px'
                          }}>
                            <span>üìà</span> Acts by Category
                          </div>
                          {getCategoryBreakdown().map(({ jar, count }) => {
                            const maxCount = Math.max(...getCategoryBreakdown().map(b => b.count));
                            const percentage = (count / maxCount) * 100;

                            return (
                              <div key={jar.id} className="category-bar">
                                <div className="category-bar-label">
                                  {jar.icon} {jar.name}
                                </div>
                                <div className="category-bar-fill">
                                  <div
                                    className="category-bar-value"
                                    style={{ width: `${percentage}%` }}
                                  >
                                    {count}
                                  </div>
                                </div>
                              </div>
                            );
                          })}
                        </div>
                      </>
                    )}

                    {/* Trends Tab */}
                    {statsTab === 'trends' && (
                      <>
                        {/* Last 7 Days Chart */}
                        <div className="stats-section">
                          <div style={{
                            fontSize: '0.9rem',
                            fontWeight: '600',
                            color: '#4A5568',
                            marginBottom: '15px',
                            textTransform: 'uppercase',
                            letterSpacing: '1px',
                            display: 'flex',
                            alignItems: 'center',
                            gap: '8px'
                          }}>
                            <span>üìÖ</span> Last 7 Days Activity
                          </div>
                          <div className="day-chart">
                            {getLast7Days().map(({ day, count, date }) => {
                              const maxCount = Math.max(...getLast7Days().map(d => d.count), 1);
                              const height = (count / maxCount) * 100;

                              return (
                                <div
                                  key={date}
                                  className="day-bar"
                                  style={{ height: `${height}%` }}
                                  title={`${day}: ${count} acts`}
                                >
                                  {count > 0 && <div className="day-bar-count">{count}</div>}
                                  <div className="day-bar-label">{day}</div>
                                </div>
                              );
                            })}
                          </div>
                          <div style={{ height: '30px' }}></div>
                        </div>

                        {/* Best Day */}
                        {getBestDayOfWeek() && (
                          <div className="stats-section">
                            <div style={{
                              fontSize: '0.9rem',
                              fontWeight: '600',
                              color: '#4A5568',
                              marginBottom: '15px',
                              textTransform: 'uppercase',
                              letterSpacing: '1px',
                              display: 'flex',
                              alignItems: 'center',
                              gap: '8px'
                            }}>
                              <span>‚≠ê</span> Your Most Active Day
                            </div>
                            <div style={{
                              textAlign: 'center',
                              padding: '20px',
                              background: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',
                              borderRadius: '12px',
                              color: 'white'
                            }}>
                              <div style={{ fontSize: '2rem', fontWeight: 'bold', marginBottom: '5px' }}>
                                {getBestDayOfWeek().day}
                              </div>
                              <div style={{ fontSize: '1rem', opacity: 0.9 }}>
                                {getBestDayOfWeek().count} acts completed on {getBestDayOfWeek().day}s
                              </div>
                            </div>
                          </div>
                        )}

                        {/* Most Active Category */}
                        {getMostActiveCategory() && (
                          <div className="stats-section">
                            <div style={{
                              fontSize: '0.9rem',
                              fontWeight: '600',
                              color: '#4A5568',
                              marginBottom: '15px',
                              textTransform: 'uppercase',
                              letterSpacing: '1px',
                              display: 'flex',
                              alignItems: 'center',
                              gap: '8px'
                            }}>
                              <span>üèÜ</span> Your Focus Area
                            </div>
                            <div style={{
                              textAlign: 'center',
                              padding: '20px',
                              background: 'linear-gradient(135deg, #48BB78 0%, #38A169 100%)',
                              borderRadius: '12px',
                              color: 'white'
                            }}>
                              <div style={{ fontSize: '3rem', marginBottom: '10px' }}>
                                {getMostActiveCategory().jar.icon}
                              </div>
                              <div style={{ fontSize: '1.5rem', fontWeight: 'bold', marginBottom: '5px' }}>
                                {getMostActiveCategory().jar.name}
                              </div>
                              <div style={{ fontSize: '1rem', opacity: 0.9 }}>
                                {getMostActiveCategory().count} acts in this category
                              </div>
                            </div>
                          </div>
                        )}
                      </>
                    )}

                    {/* Insights Tab */}
                    {statsTab === 'insights' && (
                      <>
                        {getInsights().map((insight, index) => (
                          <div
                            key={index}
                            className={`insight-box ${insight.type}`}
                            style={{ marginBottom: index < getInsights().length - 1 ? '15px' : '0' }}
                          >
                            <div className="insight-text">
                              <span style={{ fontSize: '1.5rem', marginRight: '10px' }}>
                                {insight.icon}
                              </span>
                              {insight.text}
                            </div>
                          </div>
                        ))}

                        {/* Encouragement Message */}
                        <div style={{
                          marginTop: '20px',
                          padding: '20px',
                          background: 'linear-gradient(135deg, #FFF5F5 0%, #FED7D7 100%)',
                          borderRadius: '12px',
                          textAlign: 'center'
                        }}>
                          <div style={{ fontSize: '2rem', marginBottom: '10px' }}>üíñ</div>
                          <div style={{ fontSize: '1.1rem', color: '#2D3748', lineHeight: '1.6' }}>
                            You're making the world a better place, one kind act at a time. Keep spreading love!
                          </div>
                        </div>
                      </>
                    )}
                  </>
                ) : (
                  <div style={{
                    fontSize: '1.1rem',
                    color: '#718096',
                    textAlign: 'center',
                    padding: '40px 20px',
                    lineHeight: '1.8'
                  }}>
                    <div style={{ fontSize: '4rem', marginBottom: '20px' }}>üå±</div>
                    <div style={{ marginBottom: '15px' }}>
                      Your kindness journey starts here!
                    </div>
                    <div>
                      Click any jar above to begin spreading love and watch your impact grow.
                    </div>
                  </div>
                )}

                <div className="note-buttons" style={{ marginTop: '25px' }}>
                  <button className="note-button primary" onClick={() => setShowStats(false)}>
                    Close
                  </button>
                </div>
              </div>
            </div>
          )}

          {showDonation && (
            <div className="donation-modal" onClick={(e) => {
              if (e.target.className === 'donation-modal') setShowDonation(false);
            }}>
              <div className="donation-content">
                <h2 className="donation-title">Support Kindness Jar! üíñ</h2>
                <p className="donation-message">
                  If this app brings joy to your life, consider supporting its development!
                </p>
                <div className="donation-options">
                  {[3, 5, 10, 20].map(amount => (
                    <div
                      key={amount}
                      className={`donation-amount ${donationAmount === amount ? 'selected' : ''}`}
                      onClick={() => setDonationAmount(amount)}
                    >
                      ${amount}
                    </div>
                  ))}
                </div>
                <input
                  type="number"
                  className="custom-amount"
                  placeholder="Custom amount"
                  value={donationAmount}
                  onChange={(e) => setDonationAmount(Number(e.target.value))}
                  min="1"
                />
                <div className="note-buttons">
                  <button className="note-button primary" onClick={handleDonate}>
                    üíù Donate ${donationAmount}
                  </button>
                  <button className="note-button tertiary" onClick={() => setShowDonation(false)}>
                    Maybe Later
                  </button>
                </div>
              </div>
            </div>
          )}

          {editingJar && (
            <div className="edit-image-modal" onClick={(e) => {
              if (e.target.className === 'edit-image-modal') handleCancelEdit();
            }}>
              <div className="edit-image-content">
                <h2 className="donation-title">Customize {editingJar.name} Icon</h2>
                <p className="image-info">
                  Upload a photo to personalize this jar. Perfect for adding family photos!
                </p>
                <div className="edit-image-preview">
                  {previewImage ? (
                    <img src={previewImage} alt="Preview" />
                  ) : customImages[editingJar.id] ? (
                    <img src={customImages[editingJar.id]} alt="Current" />
                  ) : (
                    <i className={editingJar.icon} style={{ fontSize: '5rem' }}></i>
                  )}
                </div>
                <input
                  type="file"
                  id="imageUpload"
                  className="image-upload-input"
                  accept="image/*"
                  capture="environment"
                  onChange={handleImageUpload}
                />
                <label htmlFor="imageUpload" className="image-upload-label">
                  üì∑ {customImages[editingJar.id] ? 'Change Photo' : 'Upload Photo'}
                </label>
                <div className="note-buttons">
                  {previewImage && (
                    <button className="note-button primary" onClick={handleSaveImage}>
                      ‚úì Save Photo
                    </button>
                  )}
                  {customImages[editingJar.id] && (
                    <button className="note-button secondary" onClick={handleRemoveImage}>
                      üóëÔ∏è Remove Photo
                    </button>
                  )}
                  <button className="note-button tertiary" onClick={handleCancelEdit}>
                    Cancel
                  </button>
                </div>
              </div>
            </div>
          )}
        </div>
      );
    }

    ReactDOM.render(<App />, document.getElementById('root'));
  </script>

  <!-- Service Worker Registration -->
  <script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('/service-worker.js')
          .then(registration => {
            console.log('‚úÖ ServiceWorker registered:', registration);
          })
          .catch(error => {
            console.log('‚ùå ServiceWorker registration failed:', error);
          });
      });
    }
  </script>
</body>

</html>